<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>jumpscale.clients.github.repo API documentation</title>
<meta name="description" content="" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>jumpscale.clients.github.repo</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">import base64
import copy
import threading

# import collections
import urllib

from gevent import sleep
from jumpscale.clients.base import Client
from jumpscale.core.base import Base, fields
from jumpscale.loader import j

from github.GithubException import UnknownObjectException

from .base import replacelabels
from .helper import retry
from .issue import Issue
from .milestone import RepoMilestone


class GithubRepo:
    TYPES = [&#34;story&#34;, &#34;ticket&#34;, &#34;task&#34;, &#34;bug&#34;, &#34;feature&#34;, &#34;question&#34;, &#34;monitor&#34;, &#34;unknown&#34;]
    PRIORITIES = [&#34;critical&#34;, &#34;urgent&#34;, &#34;normal&#34;, &#34;minor&#34;]

    STATES = [&#34;new&#34;, &#34;accepted&#34;, &#34;question&#34;, &#34;inprogress&#34;, &#34;verification&#34;, &#34;closed&#34;]

    def __init__(self, client, fullname):
        self.client = client
        self.fullname = fullname
        self._repoclient = None
        self._labels = None
        self._issues = None
        self._lock = threading.RLock()
        self._milestones = None

    def _log_info(self, s):
        pass

    @property
    def api(self):
        if self._repoclient is None:
            self._repoclient = self.client.get_repo(self.fullname)
        return self._repoclient

    @property
    def name(self):
        return self.fullname.split(&#34;/&#34;, 1)[-1]

    @property
    def type(self):
        if self.name in [&#34;home&#34;]:
            return &#34;home&#34;
        elif self.name.startswith(&#34;proj&#34;):
            return &#34;proj&#34;
        elif self.name.startswith(&#34;org_&#34;):
            return &#34;org&#34;
        elif self.name.startswith(&#34;www&#34;):
            return &#34;www&#34;
        elif self.name.startswith(&#34;doc&#34;):
            return &#34;doc&#34;
        elif self.name.startswith(&#34;cockpit&#34;):
            return &#34;cockpit&#34;
        else:
            return &#34;code&#34;

    @property
    def labelnames(self):
        return [item.name for item in self.labels]

    @property
    def labels(self):
        with self._lock:
            if self._labels is None:
                self._labels = [item for item in self.api.get_labels()]

        return self._labels

    @property
    def branches(self):
        &#34;&#34;&#34;list of `Branch` objects&#34;&#34;&#34;
        return list(self.api.get_branches())

    @property
    def stories(self):
        # walk overall issues find the stories (based on type)
        # only for home type repo, otherwise return []
        return self.issues_by_type(&#34;story&#34;)

    @property
    def tasks(self):
        # walk overall issues find the stories (based on type)
        # only for home type repo, otherwise return []
        return self.issues_by_type(&#34;task&#34;)

    def labelsSet(self, labels2set, ignoreDelete=[&#34;p_&#34;], delete=True):
        &#34;&#34;&#34;
        @param ignore all labels starting with ignore will not be deleted
        &#34;&#34;&#34;

        for item in labels2set:
            if not isinstance(item, str):
                raise Exception(&#34;Labels to set need to be in string format, found:%s&#34; % labels2set)

        # walk over github existing labels
        labelstowalk = copy.copy(self.labels)
        for item in labelstowalk:
            name = item.name.lower()
            if name not in labels2set:
                # label in repo does not correspond to label we need
                if name in replacelabels:
                    nameNew = replacelabels[item.name.lower()]
                    if nameNew not in self.labelnames:
                        color = self.get_color(name)
                        self._log_info(
                            &#34;change label in repo: %s oldlabel:&#39;%s&#39; to:&#39;%s&#39; color:%s&#34;
                            % (self.fullname, item.name, nameNew, color)
                        )
                        item.edit(nameNew, color)
                        self._labels = None
                else:
                    # no replacement
                    name = &#34;type_unknown&#34;
                    color = self.get_color(name)
                    try:
                        item.edit(name, color)
                    except BaseException:
                        item.delete()
                    self._labels = None

        # walk over new labels we need to set
        for name in labels2set:
            if name not in self.labelnames:
                # does not exist yet in repo
                color = self.get_color(name)
                self._log_info(&#34;create label: %s %s %s&#34; % (self.fullname, name, color))
                self.api.create_label(name, color)
                self._labels = None

        name = &#34;&#34;

        if delete:
            labelstowalk = copy.copy(self.labels)
            for item in labelstowalk:
                if item.name not in labels2set:
                    self._log_info(&#34;delete label: %s %s&#34; % (self.fullname, item.name))
                    ignoreDeleteDo = False
                    for filteritem in ignoreDelete:
                        if item.name.startswith(filteritem):
                            ignoreDeleteDo = True
                    if ignoreDeleteDo is False:
                        item.delete()
                    self._labels = None

        # check the colors
        labelstowalk = copy.copy(self.labels)
        for item in labelstowalk:
            # we recognise the label
            self._log_info(&#34;check color of repo:%s labelname:&#39;%s&#39;&#34; % (self.fullname, item.name))
            color = self.get_color(item.name)
            if item.color != color:
                self._log_info(&#34;change label color for repo %s %s&#34; % (item.name, color))
                item.edit(item.name, color)
                self._labels = None

    def getlabel(self, name):
        for item in self.labels:
            self._log_info(&#34;%s:look for name:&#39;%s&#39;&#34; % (item.name, name))
            if item.name == name:
                return item
        raise Exception(&#34;Dit not find label: &#39;%s&#39;&#34; % name)

    def get_issue_from_markdown(self, issueNumber, markdown):
        i = self.get_issue(issueNumber, False)
        i._loadMD(markdown)
        self.issues.append(i)
        return i

    def get_issue(self, issueNumber, die=True):
        for issue in self.issues:
            if issue.number == issueNumber:
                return issue
        # not found in cache, try to load from github
        github_issue = self.api.get_issue(issueNumber)

        if github_issue:
            issue = Issue(repo=self, githubObj=github_issue)
            self._issues.append(issue)
            return issue

        if die:
            raise Exception(&#34;cannot find issue:%s in repo:%s&#34; % (issueNumber, self))
        else:
            i = Issue(self)
            i._ddict[&#34;number&#34;] = issueNumber
            return i

    def issues_by_type(self, *types):
        &#34;&#34;&#34;
        filter is method which takes  issue as argument and returns True or False to include
        &#34;&#34;&#34;
        issues = []
        for issue in self.issues:
            if issue.type in types:
                issues.append(issue)

        return issues

    def issues_by_state(self, filter=None):
        &#34;&#34;&#34;
        filter is method which takes  issue as argument and returns True or False to include
        &#34;&#34;&#34;
        res = {}
        for item in self.states:
            res[item] = []
            for issue in self.issues:
                if issue.state == item:
                    if filter is None or filter(issue):
                        res[item].append(issue)
        return res

    def issues_by_priority(self, filter=None):
        &#34;&#34;&#34;
        filter is method which takes  issue as argument and returns True or False to include
        &#34;&#34;&#34;
        res = {}
        for item in self.priorities:
            res[item] = []
            for issue in self.issues:
                if issue.priority == item:
                    if filter is None or filter(issue):
                        res[item].append(issue)
        return res

    def issues_by_type_state(self, filter=None, collapsepriority=True):
        &#34;&#34;&#34;
        filter is method which takes  issue as argument and returns True or False to include
        returns dict of dict keys: type, state and then issues sorted following priority
        &#34;&#34;&#34;
        res = {}
        for type in self.types:
            res[type] = {}
            for state in self.states:
                res[type][state] = {}
                for priority in self.priorities:
                    res[type][state][priority] = []
                    for issue in self.issues:
                        if issue.type == type and issue.state == state:
                            if filter is None or filter(issue):
                                res[type][state][priority].append(issue)
                if collapsepriority:
                    # sort the issues following priority
                    temp = res[type][state]
                    res[type][state] = []
                    for priority in self.priorities:
                        for subitem in temp[priority]:
                            res[type][state].append(subitem)
        return res

    @property
    def types(self):
        return GithubRepo.TYPES

    @property
    def priorities(self):
        return GithubRepo.PRIORITIES

    @property
    def states(self):
        return GithubRepo.STATES

    @property
    def milestones(self):
        if self._milestones is None:
            self._milestones = [RepoMilestone(self, x) for x in self.api.get_milestones()]

        return self._milestones

    @property
    def milestone_titles(self):
        return [item.title for item in self.milestones]

    @property
    def milestone_names(self):
        return [item.name for item in self.milestones]

    def get_milestone(self, name, die=True):
        name = name.strip()
        if name == &#34;&#34;:
            raise Exception(&#34;Name cannot be empty.&#34;)
        for item in self.milestones:
            if name == item.name.strip() or name == item.title.strip():
                return item
        if die:
            raise Exception(&#34;Could not find milestone with name:%s&#34; % name)
        else:
            return None

    @retry
    def create_milestone(self, name, title, description=&#34;&#34;, deadline=&#34;&#34;, owner=&#34;&#34;):
        self._log_info(&#39;Attempt to create milestone &#34;%s&#34; [%s] deadline %s&#39; % (name, title, deadline))

        def getBody(descr, name, owner):
            out = &#34;%s\n\n&#34; % descr
            out += &#34;## name:%s\n&#34; % name
            out += &#34;## owner:%s\n&#34; % owner
            return out

        ms = None
        for s in [name, title]:
            ms = self.get_milestone(s, die=False)
            if ms is not None:
                break

        if ms is not None:
            if ms.title != title:
                ms.title = title
            # if ms.deadline != deadline:
            #     ms.deadline = deadline
            tocheck = getBody(description.strip(), name, owner)
            if ms.body.strip() != tocheck.strip():
                ms.body = tocheck
        else:
            # due = j.data.time.epoch2pythonDateTime(int(j.data.time.getEpochFuture(deadline)))
            self._log_info(&#34;Create milestone on %s: %s&#34; % (self, title))
            body = getBody(description.strip(), name, owner)
            # workaround for https://github.com/PyGithub/PyGithub/issues/396
            milestone = self.api.create_milestone(title=title, description=body)
            milestone.edit(title=title)

            self._milestones.append(RepoMilestone(self, milestone))

    def delete_milestone(self, name):
        if name.strip() == &#34;&#34;:
            raise Exception(&#34;Name cannot be empty.&#34;)
        self._log_info(&#34;Delete milestone on %s: &#39;%s&#39;&#34; % (self, name))
        try:
            ms = self.get_milestone(name)
            ms.api.delete()
            self._milestones = []
        except Exception:
            self._log_info(&#34;Milestone &#39;%s&#39; doesn&#39;t exist. no need to delete&#34; % name)

    def _labelsubset(self, cat):
        res = []
        for item in self.labels:
            if item.startswith(cat):
                item = item[len(cat) :].strip(&#34;_&#34;)
                res.append(item)
        res.sort()
        return res

    def get_color(self, name):

        # colors={&#39;state_question&#39;:&#39;fbca04&#39;,
        #  &#39;priority_urgent&#39;:&#39;d93f0b&#39;,
        #  &#39;state_verification&#39;:&#39;006b75&#39;,
        #  &#39;priority_minor&#39;:&#39;&#39;,
        #  &#39;type_task&#39;:&#39;&#39;,
        #  &#39;type_feature&#39;:&#39;&#39;,
        #  &#39;process_wontfix&#39;:&#34;ffffff&#34;,
        #  &#39;priority_critical&#39;:&#34;b60205&#34;,
        #  &#39;state_inprogress&#39;:&#34;e6e6e6&#34;,
        #  &#39;priority_normal&#39;:&#34;e6e6e6&#34;,
        #  &#39;type_story&#39;:&#34;ee9a00&#34;,
        #  &#39;process_duplicate&#39;:&#34;&#34;,
        #  &#39;state_closed&#39;:&#34;5319e7&#34;,
        #  &#39;type_bug&#39;:&#34;fc2929&#34;,
        #  &#39;state_accepted&#39;:&#34;0e8a16&#34;,
        #  &#39;type_question&#39;:&#34;fbca04&#34;,
        #  &#39;state_new&#39;:&#34;1d76db&#34;}

        if name.startswith(&#34;state&#34;):
            return &#34;c2e0c6&#34;  # light green

        if name.startswith(&#34;process&#34;):
            return &#34;d4c5f9&#34;  # light purple

        if name.startswith(&#34;type&#34;):
            return &#34;fef2c0&#34;  # light yellow

        if name in (&#34;priority_critical&#34;, &#34;task_no_estimation&#34;):
            return &#34;b60205&#34;  # red

        if name.startswith(&#34;priority_urgent&#34;):
            return &#34;d93f0b&#34;

        if name.startswith(&#34;priority&#34;):
            return &#34;f9d0c4&#34;  # roze

        return &#34;ffffff&#34;

    @retry
    def set_file(self, path, content, message=&#34;update file&#34;):
        &#34;&#34;&#34;
        Creates or updates the file content at path with given content
        :param path: file path `README.md`
        :param content: Plain content of file
        :return:
        &#34;&#34;&#34;
        bytes = content.encode()
        encoded = base64.encodebytes(bytes)

        params = {&#34;message&#34;: message, &#34;content&#34;: encoded.decode()}

        path = urllib.parse.quote(path)
        try:
            obj = self.api.get_contents(path)
            params[&#34;sha&#34;] = obj.sha
            if base64.decodebytes(obj.content.encode()) == bytes:
                return
        except UnknownObjectException:
            pass

        self._log_info(&#39;Updating file &#34;%s&#34;&#39; % path)
        self.api._requester.requestJsonAndCheck(&#34;PUT&#34;, self.api.url + &#34;/contents/&#34; + path, input=params)

    @property
    def issues(self):
        with self._lock:
            if self._issues is None:
                issues = []
                for item in self.api.get_issues(state=&#34;all&#34;):
                    issues.append(Issue(self, githubObj=item))

                self._issues = issues

        return self._issues

    def download_directory(self, src, download_dir, branch=None):
        dest = j.sals.fs.join_paths(download_dir, self.api.full_name)
        j.sals.fs.mkdirs(dest)
        branch = branch or self.api.default_branch
        contents = self.api.get_dir_contents(src, ref=branch)

        for content in contents:
            if content.type == &#34;dir&#34;:
                dir_path = j.sals.fs.join_paths(dest, content.path)
                j.sals.fs.mkdirs(dir_path)
                self.download_directory(content.path, download_dir, branch)
            else:
                file_path = j.sals.fs.join_paths(dest, content.path)
                j.sals.fs.mkdirs(j.sals.fs.dirname(file_path))
                file_content = self.api.get_contents(content.path, ref=branch)
                with open(file_path, &#34;+w&#34;) as f:
                    f.write(base64.b64decode(file_content.content).decode())

        return j.sals.fs.join_paths(dest, src)

    def get_git_tree(self, sha_or_branch):
        &#34;&#34;&#34;return a list of `GitTreeElement` for every element in source tree&#34;&#34;&#34;
        return self.api.get_git_tree(sha_or_branch).tree

    def __str__(self):
        return &#34;gitrepo:%s&#34; % self.fullname

    __repr__ = __str__</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="jumpscale.clients.github.repo.GithubRepo"><code class="flex name class">
<span>class <span class="ident">GithubRepo</span></span>
<span>(</span><span>client, fullname)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class GithubRepo:
    TYPES = [&#34;story&#34;, &#34;ticket&#34;, &#34;task&#34;, &#34;bug&#34;, &#34;feature&#34;, &#34;question&#34;, &#34;monitor&#34;, &#34;unknown&#34;]
    PRIORITIES = [&#34;critical&#34;, &#34;urgent&#34;, &#34;normal&#34;, &#34;minor&#34;]

    STATES = [&#34;new&#34;, &#34;accepted&#34;, &#34;question&#34;, &#34;inprogress&#34;, &#34;verification&#34;, &#34;closed&#34;]

    def __init__(self, client, fullname):
        self.client = client
        self.fullname = fullname
        self._repoclient = None
        self._labels = None
        self._issues = None
        self._lock = threading.RLock()
        self._milestones = None

    def _log_info(self, s):
        pass

    @property
    def api(self):
        if self._repoclient is None:
            self._repoclient = self.client.get_repo(self.fullname)
        return self._repoclient

    @property
    def name(self):
        return self.fullname.split(&#34;/&#34;, 1)[-1]

    @property
    def type(self):
        if self.name in [&#34;home&#34;]:
            return &#34;home&#34;
        elif self.name.startswith(&#34;proj&#34;):
            return &#34;proj&#34;
        elif self.name.startswith(&#34;org_&#34;):
            return &#34;org&#34;
        elif self.name.startswith(&#34;www&#34;):
            return &#34;www&#34;
        elif self.name.startswith(&#34;doc&#34;):
            return &#34;doc&#34;
        elif self.name.startswith(&#34;cockpit&#34;):
            return &#34;cockpit&#34;
        else:
            return &#34;code&#34;

    @property
    def labelnames(self):
        return [item.name for item in self.labels]

    @property
    def labels(self):
        with self._lock:
            if self._labels is None:
                self._labels = [item for item in self.api.get_labels()]

        return self._labels

    @property
    def branches(self):
        &#34;&#34;&#34;list of `Branch` objects&#34;&#34;&#34;
        return list(self.api.get_branches())

    @property
    def stories(self):
        # walk overall issues find the stories (based on type)
        # only for home type repo, otherwise return []
        return self.issues_by_type(&#34;story&#34;)

    @property
    def tasks(self):
        # walk overall issues find the stories (based on type)
        # only for home type repo, otherwise return []
        return self.issues_by_type(&#34;task&#34;)

    def labelsSet(self, labels2set, ignoreDelete=[&#34;p_&#34;], delete=True):
        &#34;&#34;&#34;
        @param ignore all labels starting with ignore will not be deleted
        &#34;&#34;&#34;

        for item in labels2set:
            if not isinstance(item, str):
                raise Exception(&#34;Labels to set need to be in string format, found:%s&#34; % labels2set)

        # walk over github existing labels
        labelstowalk = copy.copy(self.labels)
        for item in labelstowalk:
            name = item.name.lower()
            if name not in labels2set:
                # label in repo does not correspond to label we need
                if name in replacelabels:
                    nameNew = replacelabels[item.name.lower()]
                    if nameNew not in self.labelnames:
                        color = self.get_color(name)
                        self._log_info(
                            &#34;change label in repo: %s oldlabel:&#39;%s&#39; to:&#39;%s&#39; color:%s&#34;
                            % (self.fullname, item.name, nameNew, color)
                        )
                        item.edit(nameNew, color)
                        self._labels = None
                else:
                    # no replacement
                    name = &#34;type_unknown&#34;
                    color = self.get_color(name)
                    try:
                        item.edit(name, color)
                    except BaseException:
                        item.delete()
                    self._labels = None

        # walk over new labels we need to set
        for name in labels2set:
            if name not in self.labelnames:
                # does not exist yet in repo
                color = self.get_color(name)
                self._log_info(&#34;create label: %s %s %s&#34; % (self.fullname, name, color))
                self.api.create_label(name, color)
                self._labels = None

        name = &#34;&#34;

        if delete:
            labelstowalk = copy.copy(self.labels)
            for item in labelstowalk:
                if item.name not in labels2set:
                    self._log_info(&#34;delete label: %s %s&#34; % (self.fullname, item.name))
                    ignoreDeleteDo = False
                    for filteritem in ignoreDelete:
                        if item.name.startswith(filteritem):
                            ignoreDeleteDo = True
                    if ignoreDeleteDo is False:
                        item.delete()
                    self._labels = None

        # check the colors
        labelstowalk = copy.copy(self.labels)
        for item in labelstowalk:
            # we recognise the label
            self._log_info(&#34;check color of repo:%s labelname:&#39;%s&#39;&#34; % (self.fullname, item.name))
            color = self.get_color(item.name)
            if item.color != color:
                self._log_info(&#34;change label color for repo %s %s&#34; % (item.name, color))
                item.edit(item.name, color)
                self._labels = None

    def getlabel(self, name):
        for item in self.labels:
            self._log_info(&#34;%s:look for name:&#39;%s&#39;&#34; % (item.name, name))
            if item.name == name:
                return item
        raise Exception(&#34;Dit not find label: &#39;%s&#39;&#34; % name)

    def get_issue_from_markdown(self, issueNumber, markdown):
        i = self.get_issue(issueNumber, False)
        i._loadMD(markdown)
        self.issues.append(i)
        return i

    def get_issue(self, issueNumber, die=True):
        for issue in self.issues:
            if issue.number == issueNumber:
                return issue
        # not found in cache, try to load from github
        github_issue = self.api.get_issue(issueNumber)

        if github_issue:
            issue = Issue(repo=self, githubObj=github_issue)
            self._issues.append(issue)
            return issue

        if die:
            raise Exception(&#34;cannot find issue:%s in repo:%s&#34; % (issueNumber, self))
        else:
            i = Issue(self)
            i._ddict[&#34;number&#34;] = issueNumber
            return i

    def issues_by_type(self, *types):
        &#34;&#34;&#34;
        filter is method which takes  issue as argument and returns True or False to include
        &#34;&#34;&#34;
        issues = []
        for issue in self.issues:
            if issue.type in types:
                issues.append(issue)

        return issues

    def issues_by_state(self, filter=None):
        &#34;&#34;&#34;
        filter is method which takes  issue as argument and returns True or False to include
        &#34;&#34;&#34;
        res = {}
        for item in self.states:
            res[item] = []
            for issue in self.issues:
                if issue.state == item:
                    if filter is None or filter(issue):
                        res[item].append(issue)
        return res

    def issues_by_priority(self, filter=None):
        &#34;&#34;&#34;
        filter is method which takes  issue as argument and returns True or False to include
        &#34;&#34;&#34;
        res = {}
        for item in self.priorities:
            res[item] = []
            for issue in self.issues:
                if issue.priority == item:
                    if filter is None or filter(issue):
                        res[item].append(issue)
        return res

    def issues_by_type_state(self, filter=None, collapsepriority=True):
        &#34;&#34;&#34;
        filter is method which takes  issue as argument and returns True or False to include
        returns dict of dict keys: type, state and then issues sorted following priority
        &#34;&#34;&#34;
        res = {}
        for type in self.types:
            res[type] = {}
            for state in self.states:
                res[type][state] = {}
                for priority in self.priorities:
                    res[type][state][priority] = []
                    for issue in self.issues:
                        if issue.type == type and issue.state == state:
                            if filter is None or filter(issue):
                                res[type][state][priority].append(issue)
                if collapsepriority:
                    # sort the issues following priority
                    temp = res[type][state]
                    res[type][state] = []
                    for priority in self.priorities:
                        for subitem in temp[priority]:
                            res[type][state].append(subitem)
        return res

    @property
    def types(self):
        return GithubRepo.TYPES

    @property
    def priorities(self):
        return GithubRepo.PRIORITIES

    @property
    def states(self):
        return GithubRepo.STATES

    @property
    def milestones(self):
        if self._milestones is None:
            self._milestones = [RepoMilestone(self, x) for x in self.api.get_milestones()]

        return self._milestones

    @property
    def milestone_titles(self):
        return [item.title for item in self.milestones]

    @property
    def milestone_names(self):
        return [item.name for item in self.milestones]

    def get_milestone(self, name, die=True):
        name = name.strip()
        if name == &#34;&#34;:
            raise Exception(&#34;Name cannot be empty.&#34;)
        for item in self.milestones:
            if name == item.name.strip() or name == item.title.strip():
                return item
        if die:
            raise Exception(&#34;Could not find milestone with name:%s&#34; % name)
        else:
            return None

    @retry
    def create_milestone(self, name, title, description=&#34;&#34;, deadline=&#34;&#34;, owner=&#34;&#34;):
        self._log_info(&#39;Attempt to create milestone &#34;%s&#34; [%s] deadline %s&#39; % (name, title, deadline))

        def getBody(descr, name, owner):
            out = &#34;%s\n\n&#34; % descr
            out += &#34;## name:%s\n&#34; % name
            out += &#34;## owner:%s\n&#34; % owner
            return out

        ms = None
        for s in [name, title]:
            ms = self.get_milestone(s, die=False)
            if ms is not None:
                break

        if ms is not None:
            if ms.title != title:
                ms.title = title
            # if ms.deadline != deadline:
            #     ms.deadline = deadline
            tocheck = getBody(description.strip(), name, owner)
            if ms.body.strip() != tocheck.strip():
                ms.body = tocheck
        else:
            # due = j.data.time.epoch2pythonDateTime(int(j.data.time.getEpochFuture(deadline)))
            self._log_info(&#34;Create milestone on %s: %s&#34; % (self, title))
            body = getBody(description.strip(), name, owner)
            # workaround for https://github.com/PyGithub/PyGithub/issues/396
            milestone = self.api.create_milestone(title=title, description=body)
            milestone.edit(title=title)

            self._milestones.append(RepoMilestone(self, milestone))

    def delete_milestone(self, name):
        if name.strip() == &#34;&#34;:
            raise Exception(&#34;Name cannot be empty.&#34;)
        self._log_info(&#34;Delete milestone on %s: &#39;%s&#39;&#34; % (self, name))
        try:
            ms = self.get_milestone(name)
            ms.api.delete()
            self._milestones = []
        except Exception:
            self._log_info(&#34;Milestone &#39;%s&#39; doesn&#39;t exist. no need to delete&#34; % name)

    def _labelsubset(self, cat):
        res = []
        for item in self.labels:
            if item.startswith(cat):
                item = item[len(cat) :].strip(&#34;_&#34;)
                res.append(item)
        res.sort()
        return res

    def get_color(self, name):

        # colors={&#39;state_question&#39;:&#39;fbca04&#39;,
        #  &#39;priority_urgent&#39;:&#39;d93f0b&#39;,
        #  &#39;state_verification&#39;:&#39;006b75&#39;,
        #  &#39;priority_minor&#39;:&#39;&#39;,
        #  &#39;type_task&#39;:&#39;&#39;,
        #  &#39;type_feature&#39;:&#39;&#39;,
        #  &#39;process_wontfix&#39;:&#34;ffffff&#34;,
        #  &#39;priority_critical&#39;:&#34;b60205&#34;,
        #  &#39;state_inprogress&#39;:&#34;e6e6e6&#34;,
        #  &#39;priority_normal&#39;:&#34;e6e6e6&#34;,
        #  &#39;type_story&#39;:&#34;ee9a00&#34;,
        #  &#39;process_duplicate&#39;:&#34;&#34;,
        #  &#39;state_closed&#39;:&#34;5319e7&#34;,
        #  &#39;type_bug&#39;:&#34;fc2929&#34;,
        #  &#39;state_accepted&#39;:&#34;0e8a16&#34;,
        #  &#39;type_question&#39;:&#34;fbca04&#34;,
        #  &#39;state_new&#39;:&#34;1d76db&#34;}

        if name.startswith(&#34;state&#34;):
            return &#34;c2e0c6&#34;  # light green

        if name.startswith(&#34;process&#34;):
            return &#34;d4c5f9&#34;  # light purple

        if name.startswith(&#34;type&#34;):
            return &#34;fef2c0&#34;  # light yellow

        if name in (&#34;priority_critical&#34;, &#34;task_no_estimation&#34;):
            return &#34;b60205&#34;  # red

        if name.startswith(&#34;priority_urgent&#34;):
            return &#34;d93f0b&#34;

        if name.startswith(&#34;priority&#34;):
            return &#34;f9d0c4&#34;  # roze

        return &#34;ffffff&#34;

    @retry
    def set_file(self, path, content, message=&#34;update file&#34;):
        &#34;&#34;&#34;
        Creates or updates the file content at path with given content
        :param path: file path `README.md`
        :param content: Plain content of file
        :return:
        &#34;&#34;&#34;
        bytes = content.encode()
        encoded = base64.encodebytes(bytes)

        params = {&#34;message&#34;: message, &#34;content&#34;: encoded.decode()}

        path = urllib.parse.quote(path)
        try:
            obj = self.api.get_contents(path)
            params[&#34;sha&#34;] = obj.sha
            if base64.decodebytes(obj.content.encode()) == bytes:
                return
        except UnknownObjectException:
            pass

        self._log_info(&#39;Updating file &#34;%s&#34;&#39; % path)
        self.api._requester.requestJsonAndCheck(&#34;PUT&#34;, self.api.url + &#34;/contents/&#34; + path, input=params)

    @property
    def issues(self):
        with self._lock:
            if self._issues is None:
                issues = []
                for item in self.api.get_issues(state=&#34;all&#34;):
                    issues.append(Issue(self, githubObj=item))

                self._issues = issues

        return self._issues

    def download_directory(self, src, download_dir, branch=None):
        dest = j.sals.fs.join_paths(download_dir, self.api.full_name)
        j.sals.fs.mkdirs(dest)
        branch = branch or self.api.default_branch
        contents = self.api.get_dir_contents(src, ref=branch)

        for content in contents:
            if content.type == &#34;dir&#34;:
                dir_path = j.sals.fs.join_paths(dest, content.path)
                j.sals.fs.mkdirs(dir_path)
                self.download_directory(content.path, download_dir, branch)
            else:
                file_path = j.sals.fs.join_paths(dest, content.path)
                j.sals.fs.mkdirs(j.sals.fs.dirname(file_path))
                file_content = self.api.get_contents(content.path, ref=branch)
                with open(file_path, &#34;+w&#34;) as f:
                    f.write(base64.b64decode(file_content.content).decode())

        return j.sals.fs.join_paths(dest, src)

    def get_git_tree(self, sha_or_branch):
        &#34;&#34;&#34;return a list of `GitTreeElement` for every element in source tree&#34;&#34;&#34;
        return self.api.get_git_tree(sha_or_branch).tree

    def __str__(self):
        return &#34;gitrepo:%s&#34; % self.fullname

    __repr__ = __str__</code></pre>
</details>
<h3>Class variables</h3>
<dl>
<dt id="jumpscale.clients.github.repo.GithubRepo.PRIORITIES"><code class="name">var <span class="ident">PRIORITIES</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="jumpscale.clients.github.repo.GithubRepo.STATES"><code class="name">var <span class="ident">STATES</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
<dt id="jumpscale.clients.github.repo.GithubRepo.TYPES"><code class="name">var <span class="ident">TYPES</span></code></dt>
<dd>
<div class="desc"></div>
</dd>
</dl>
<h3>Instance variables</h3>
<dl>
<dt id="jumpscale.clients.github.repo.GithubRepo.api"><code class="name">var <span class="ident">api</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def api(self):
    if self._repoclient is None:
        self._repoclient = self.client.get_repo(self.fullname)
    return self._repoclient</code></pre>
</details>
</dd>
<dt id="jumpscale.clients.github.repo.GithubRepo.branches"><code class="name">var <span class="ident">branches</span></code></dt>
<dd>
<div class="desc"><p>list of <code>Branch</code> objects</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def branches(self):
    &#34;&#34;&#34;list of `Branch` objects&#34;&#34;&#34;
    return list(self.api.get_branches())</code></pre>
</details>
</dd>
<dt id="jumpscale.clients.github.repo.GithubRepo.issues"><code class="name">var <span class="ident">issues</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def issues(self):
    with self._lock:
        if self._issues is None:
            issues = []
            for item in self.api.get_issues(state=&#34;all&#34;):
                issues.append(Issue(self, githubObj=item))

            self._issues = issues

    return self._issues</code></pre>
</details>
</dd>
<dt id="jumpscale.clients.github.repo.GithubRepo.labelnames"><code class="name">var <span class="ident">labelnames</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def labelnames(self):
    return [item.name for item in self.labels]</code></pre>
</details>
</dd>
<dt id="jumpscale.clients.github.repo.GithubRepo.labels"><code class="name">var <span class="ident">labels</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def labels(self):
    with self._lock:
        if self._labels is None:
            self._labels = [item for item in self.api.get_labels()]

    return self._labels</code></pre>
</details>
</dd>
<dt id="jumpscale.clients.github.repo.GithubRepo.milestone_names"><code class="name">var <span class="ident">milestone_names</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def milestone_names(self):
    return [item.name for item in self.milestones]</code></pre>
</details>
</dd>
<dt id="jumpscale.clients.github.repo.GithubRepo.milestone_titles"><code class="name">var <span class="ident">milestone_titles</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def milestone_titles(self):
    return [item.title for item in self.milestones]</code></pre>
</details>
</dd>
<dt id="jumpscale.clients.github.repo.GithubRepo.milestones"><code class="name">var <span class="ident">milestones</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def milestones(self):
    if self._milestones is None:
        self._milestones = [RepoMilestone(self, x) for x in self.api.get_milestones()]

    return self._milestones</code></pre>
</details>
</dd>
<dt id="jumpscale.clients.github.repo.GithubRepo.name"><code class="name">var <span class="ident">name</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def name(self):
    return self.fullname.split(&#34;/&#34;, 1)[-1]</code></pre>
</details>
</dd>
<dt id="jumpscale.clients.github.repo.GithubRepo.priorities"><code class="name">var <span class="ident">priorities</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def priorities(self):
    return GithubRepo.PRIORITIES</code></pre>
</details>
</dd>
<dt id="jumpscale.clients.github.repo.GithubRepo.states"><code class="name">var <span class="ident">states</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def states(self):
    return GithubRepo.STATES</code></pre>
</details>
</dd>
<dt id="jumpscale.clients.github.repo.GithubRepo.stories"><code class="name">var <span class="ident">stories</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def stories(self):
    # walk overall issues find the stories (based on type)
    # only for home type repo, otherwise return []
    return self.issues_by_type(&#34;story&#34;)</code></pre>
</details>
</dd>
<dt id="jumpscale.clients.github.repo.GithubRepo.tasks"><code class="name">var <span class="ident">tasks</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def tasks(self):
    # walk overall issues find the stories (based on type)
    # only for home type repo, otherwise return []
    return self.issues_by_type(&#34;task&#34;)</code></pre>
</details>
</dd>
<dt id="jumpscale.clients.github.repo.GithubRepo.type"><code class="name">var <span class="ident">type</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def type(self):
    if self.name in [&#34;home&#34;]:
        return &#34;home&#34;
    elif self.name.startswith(&#34;proj&#34;):
        return &#34;proj&#34;
    elif self.name.startswith(&#34;org_&#34;):
        return &#34;org&#34;
    elif self.name.startswith(&#34;www&#34;):
        return &#34;www&#34;
    elif self.name.startswith(&#34;doc&#34;):
        return &#34;doc&#34;
    elif self.name.startswith(&#34;cockpit&#34;):
        return &#34;cockpit&#34;
    else:
        return &#34;code&#34;</code></pre>
</details>
</dd>
<dt id="jumpscale.clients.github.repo.GithubRepo.types"><code class="name">var <span class="ident">types</span></code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@property
def types(self):
    return GithubRepo.TYPES</code></pre>
</details>
</dd>
</dl>
<h3>Methods</h3>
<dl>
<dt id="jumpscale.clients.github.repo.GithubRepo.create_milestone"><code class="name flex">
<span>def <span class="ident">create_milestone</span></span>(<span>self, *args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def wrapper(self, *args, **kwargs):
    for _ in range(6):
        try:
            result = function(self, *args, **kwargs)
            break
        except Exception as e:
            j.logger.warning(f&#34;Failed to execute {function.__name__} due to error: {str(e)}&#34;)
            sleep(1)
    else:
        raise j.exceptions.Runtime(f&#34;Failed to execute {function.__name__} after multiple retries&#34;)
    return result</code></pre>
</details>
</dd>
<dt id="jumpscale.clients.github.repo.GithubRepo.delete_milestone"><code class="name flex">
<span>def <span class="ident">delete_milestone</span></span>(<span>self, name)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def delete_milestone(self, name):
    if name.strip() == &#34;&#34;:
        raise Exception(&#34;Name cannot be empty.&#34;)
    self._log_info(&#34;Delete milestone on %s: &#39;%s&#39;&#34; % (self, name))
    try:
        ms = self.get_milestone(name)
        ms.api.delete()
        self._milestones = []
    except Exception:
        self._log_info(&#34;Milestone &#39;%s&#39; doesn&#39;t exist. no need to delete&#34; % name)</code></pre>
</details>
</dd>
<dt id="jumpscale.clients.github.repo.GithubRepo.download_directory"><code class="name flex">
<span>def <span class="ident">download_directory</span></span>(<span>self, src, download_dir, branch=None)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def download_directory(self, src, download_dir, branch=None):
    dest = j.sals.fs.join_paths(download_dir, self.api.full_name)
    j.sals.fs.mkdirs(dest)
    branch = branch or self.api.default_branch
    contents = self.api.get_dir_contents(src, ref=branch)

    for content in contents:
        if content.type == &#34;dir&#34;:
            dir_path = j.sals.fs.join_paths(dest, content.path)
            j.sals.fs.mkdirs(dir_path)
            self.download_directory(content.path, download_dir, branch)
        else:
            file_path = j.sals.fs.join_paths(dest, content.path)
            j.sals.fs.mkdirs(j.sals.fs.dirname(file_path))
            file_content = self.api.get_contents(content.path, ref=branch)
            with open(file_path, &#34;+w&#34;) as f:
                f.write(base64.b64decode(file_content.content).decode())

    return j.sals.fs.join_paths(dest, src)</code></pre>
</details>
</dd>
<dt id="jumpscale.clients.github.repo.GithubRepo.get_color"><code class="name flex">
<span>def <span class="ident">get_color</span></span>(<span>self, name)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_color(self, name):

    # colors={&#39;state_question&#39;:&#39;fbca04&#39;,
    #  &#39;priority_urgent&#39;:&#39;d93f0b&#39;,
    #  &#39;state_verification&#39;:&#39;006b75&#39;,
    #  &#39;priority_minor&#39;:&#39;&#39;,
    #  &#39;type_task&#39;:&#39;&#39;,
    #  &#39;type_feature&#39;:&#39;&#39;,
    #  &#39;process_wontfix&#39;:&#34;ffffff&#34;,
    #  &#39;priority_critical&#39;:&#34;b60205&#34;,
    #  &#39;state_inprogress&#39;:&#34;e6e6e6&#34;,
    #  &#39;priority_normal&#39;:&#34;e6e6e6&#34;,
    #  &#39;type_story&#39;:&#34;ee9a00&#34;,
    #  &#39;process_duplicate&#39;:&#34;&#34;,
    #  &#39;state_closed&#39;:&#34;5319e7&#34;,
    #  &#39;type_bug&#39;:&#34;fc2929&#34;,
    #  &#39;state_accepted&#39;:&#34;0e8a16&#34;,
    #  &#39;type_question&#39;:&#34;fbca04&#34;,
    #  &#39;state_new&#39;:&#34;1d76db&#34;}

    if name.startswith(&#34;state&#34;):
        return &#34;c2e0c6&#34;  # light green

    if name.startswith(&#34;process&#34;):
        return &#34;d4c5f9&#34;  # light purple

    if name.startswith(&#34;type&#34;):
        return &#34;fef2c0&#34;  # light yellow

    if name in (&#34;priority_critical&#34;, &#34;task_no_estimation&#34;):
        return &#34;b60205&#34;  # red

    if name.startswith(&#34;priority_urgent&#34;):
        return &#34;d93f0b&#34;

    if name.startswith(&#34;priority&#34;):
        return &#34;f9d0c4&#34;  # roze

    return &#34;ffffff&#34;</code></pre>
</details>
</dd>
<dt id="jumpscale.clients.github.repo.GithubRepo.get_git_tree"><code class="name flex">
<span>def <span class="ident">get_git_tree</span></span>(<span>self, sha_or_branch)</span>
</code></dt>
<dd>
<div class="desc"><p>return a list of <code>GitTreeElement</code> for every element in source tree</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_git_tree(self, sha_or_branch):
    &#34;&#34;&#34;return a list of `GitTreeElement` for every element in source tree&#34;&#34;&#34;
    return self.api.get_git_tree(sha_or_branch).tree</code></pre>
</details>
</dd>
<dt id="jumpscale.clients.github.repo.GithubRepo.get_issue"><code class="name flex">
<span>def <span class="ident">get_issue</span></span>(<span>self, issueNumber, die=True)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_issue(self, issueNumber, die=True):
    for issue in self.issues:
        if issue.number == issueNumber:
            return issue
    # not found in cache, try to load from github
    github_issue = self.api.get_issue(issueNumber)

    if github_issue:
        issue = Issue(repo=self, githubObj=github_issue)
        self._issues.append(issue)
        return issue

    if die:
        raise Exception(&#34;cannot find issue:%s in repo:%s&#34; % (issueNumber, self))
    else:
        i = Issue(self)
        i._ddict[&#34;number&#34;] = issueNumber
        return i</code></pre>
</details>
</dd>
<dt id="jumpscale.clients.github.repo.GithubRepo.get_issue_from_markdown"><code class="name flex">
<span>def <span class="ident">get_issue_from_markdown</span></span>(<span>self, issueNumber, markdown)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_issue_from_markdown(self, issueNumber, markdown):
    i = self.get_issue(issueNumber, False)
    i._loadMD(markdown)
    self.issues.append(i)
    return i</code></pre>
</details>
</dd>
<dt id="jumpscale.clients.github.repo.GithubRepo.get_milestone"><code class="name flex">
<span>def <span class="ident">get_milestone</span></span>(<span>self, name, die=True)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_milestone(self, name, die=True):
    name = name.strip()
    if name == &#34;&#34;:
        raise Exception(&#34;Name cannot be empty.&#34;)
    for item in self.milestones:
        if name == item.name.strip() or name == item.title.strip():
            return item
    if die:
        raise Exception(&#34;Could not find milestone with name:%s&#34; % name)
    else:
        return None</code></pre>
</details>
</dd>
<dt id="jumpscale.clients.github.repo.GithubRepo.getlabel"><code class="name flex">
<span>def <span class="ident">getlabel</span></span>(<span>self, name)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def getlabel(self, name):
    for item in self.labels:
        self._log_info(&#34;%s:look for name:&#39;%s&#39;&#34; % (item.name, name))
        if item.name == name:
            return item
    raise Exception(&#34;Dit not find label: &#39;%s&#39;&#34; % name)</code></pre>
</details>
</dd>
<dt id="jumpscale.clients.github.repo.GithubRepo.issues_by_priority"><code class="name flex">
<span>def <span class="ident">issues_by_priority</span></span>(<span>self, filter=None)</span>
</code></dt>
<dd>
<div class="desc"><p>filter is method which takes
issue as argument and returns True or False to include</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def issues_by_priority(self, filter=None):
    &#34;&#34;&#34;
    filter is method which takes  issue as argument and returns True or False to include
    &#34;&#34;&#34;
    res = {}
    for item in self.priorities:
        res[item] = []
        for issue in self.issues:
            if issue.priority == item:
                if filter is None or filter(issue):
                    res[item].append(issue)
    return res</code></pre>
</details>
</dd>
<dt id="jumpscale.clients.github.repo.GithubRepo.issues_by_state"><code class="name flex">
<span>def <span class="ident">issues_by_state</span></span>(<span>self, filter=None)</span>
</code></dt>
<dd>
<div class="desc"><p>filter is method which takes
issue as argument and returns True or False to include</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def issues_by_state(self, filter=None):
    &#34;&#34;&#34;
    filter is method which takes  issue as argument and returns True or False to include
    &#34;&#34;&#34;
    res = {}
    for item in self.states:
        res[item] = []
        for issue in self.issues:
            if issue.state == item:
                if filter is None or filter(issue):
                    res[item].append(issue)
    return res</code></pre>
</details>
</dd>
<dt id="jumpscale.clients.github.repo.GithubRepo.issues_by_type"><code class="name flex">
<span>def <span class="ident">issues_by_type</span></span>(<span>self, *types)</span>
</code></dt>
<dd>
<div class="desc"><p>filter is method which takes
issue as argument and returns True or False to include</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def issues_by_type(self, *types):
    &#34;&#34;&#34;
    filter is method which takes  issue as argument and returns True or False to include
    &#34;&#34;&#34;
    issues = []
    for issue in self.issues:
        if issue.type in types:
            issues.append(issue)

    return issues</code></pre>
</details>
</dd>
<dt id="jumpscale.clients.github.repo.GithubRepo.issues_by_type_state"><code class="name flex">
<span>def <span class="ident">issues_by_type_state</span></span>(<span>self, filter=None, collapsepriority=True)</span>
</code></dt>
<dd>
<div class="desc"><p>filter is method which takes
issue as argument and returns True or False to include
returns dict of dict keys: type, state and then issues sorted following priority</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def issues_by_type_state(self, filter=None, collapsepriority=True):
    &#34;&#34;&#34;
    filter is method which takes  issue as argument and returns True or False to include
    returns dict of dict keys: type, state and then issues sorted following priority
    &#34;&#34;&#34;
    res = {}
    for type in self.types:
        res[type] = {}
        for state in self.states:
            res[type][state] = {}
            for priority in self.priorities:
                res[type][state][priority] = []
                for issue in self.issues:
                    if issue.type == type and issue.state == state:
                        if filter is None or filter(issue):
                            res[type][state][priority].append(issue)
            if collapsepriority:
                # sort the issues following priority
                temp = res[type][state]
                res[type][state] = []
                for priority in self.priorities:
                    for subitem in temp[priority]:
                        res[type][state].append(subitem)
    return res</code></pre>
</details>
</dd>
<dt id="jumpscale.clients.github.repo.GithubRepo.labelsSet"><code class="name flex">
<span>def <span class="ident">labelsSet</span></span>(<span>self, labels2set, ignoreDelete=['p_'], delete=True)</span>
</code></dt>
<dd>
<div class="desc"><p>@param ignore all labels starting with ignore will not be deleted</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def labelsSet(self, labels2set, ignoreDelete=[&#34;p_&#34;], delete=True):
    &#34;&#34;&#34;
    @param ignore all labels starting with ignore will not be deleted
    &#34;&#34;&#34;

    for item in labels2set:
        if not isinstance(item, str):
            raise Exception(&#34;Labels to set need to be in string format, found:%s&#34; % labels2set)

    # walk over github existing labels
    labelstowalk = copy.copy(self.labels)
    for item in labelstowalk:
        name = item.name.lower()
        if name not in labels2set:
            # label in repo does not correspond to label we need
            if name in replacelabels:
                nameNew = replacelabels[item.name.lower()]
                if nameNew not in self.labelnames:
                    color = self.get_color(name)
                    self._log_info(
                        &#34;change label in repo: %s oldlabel:&#39;%s&#39; to:&#39;%s&#39; color:%s&#34;
                        % (self.fullname, item.name, nameNew, color)
                    )
                    item.edit(nameNew, color)
                    self._labels = None
            else:
                # no replacement
                name = &#34;type_unknown&#34;
                color = self.get_color(name)
                try:
                    item.edit(name, color)
                except BaseException:
                    item.delete()
                self._labels = None

    # walk over new labels we need to set
    for name in labels2set:
        if name not in self.labelnames:
            # does not exist yet in repo
            color = self.get_color(name)
            self._log_info(&#34;create label: %s %s %s&#34; % (self.fullname, name, color))
            self.api.create_label(name, color)
            self._labels = None

    name = &#34;&#34;

    if delete:
        labelstowalk = copy.copy(self.labels)
        for item in labelstowalk:
            if item.name not in labels2set:
                self._log_info(&#34;delete label: %s %s&#34; % (self.fullname, item.name))
                ignoreDeleteDo = False
                for filteritem in ignoreDelete:
                    if item.name.startswith(filteritem):
                        ignoreDeleteDo = True
                if ignoreDeleteDo is False:
                    item.delete()
                self._labels = None

    # check the colors
    labelstowalk = copy.copy(self.labels)
    for item in labelstowalk:
        # we recognise the label
        self._log_info(&#34;check color of repo:%s labelname:&#39;%s&#39;&#34; % (self.fullname, item.name))
        color = self.get_color(item.name)
        if item.color != color:
            self._log_info(&#34;change label color for repo %s %s&#34; % (item.name, color))
            item.edit(item.name, color)
            self._labels = None</code></pre>
</details>
</dd>
<dt id="jumpscale.clients.github.repo.GithubRepo.set_file"><code class="name flex">
<span>def <span class="ident">set_file</span></span>(<span>self, *args, **kwargs)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def wrapper(self, *args, **kwargs):
    for _ in range(6):
        try:
            result = function(self, *args, **kwargs)
            break
        except Exception as e:
            j.logger.warning(f&#34;Failed to execute {function.__name__} due to error: {str(e)}&#34;)
            sleep(1)
    else:
        raise j.exceptions.Runtime(f&#34;Failed to execute {function.__name__} after multiple retries&#34;)
    return result</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="jumpscale.clients.github" href="index.html">jumpscale.clients.github</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="jumpscale.clients.github.repo.GithubRepo" href="#jumpscale.clients.github.repo.GithubRepo">GithubRepo</a></code></h4>
<ul class="">
<li><code><a title="jumpscale.clients.github.repo.GithubRepo.PRIORITIES" href="#jumpscale.clients.github.repo.GithubRepo.PRIORITIES">PRIORITIES</a></code></li>
<li><code><a title="jumpscale.clients.github.repo.GithubRepo.STATES" href="#jumpscale.clients.github.repo.GithubRepo.STATES">STATES</a></code></li>
<li><code><a title="jumpscale.clients.github.repo.GithubRepo.TYPES" href="#jumpscale.clients.github.repo.GithubRepo.TYPES">TYPES</a></code></li>
<li><code><a title="jumpscale.clients.github.repo.GithubRepo.api" href="#jumpscale.clients.github.repo.GithubRepo.api">api</a></code></li>
<li><code><a title="jumpscale.clients.github.repo.GithubRepo.branches" href="#jumpscale.clients.github.repo.GithubRepo.branches">branches</a></code></li>
<li><code><a title="jumpscale.clients.github.repo.GithubRepo.create_milestone" href="#jumpscale.clients.github.repo.GithubRepo.create_milestone">create_milestone</a></code></li>
<li><code><a title="jumpscale.clients.github.repo.GithubRepo.delete_milestone" href="#jumpscale.clients.github.repo.GithubRepo.delete_milestone">delete_milestone</a></code></li>
<li><code><a title="jumpscale.clients.github.repo.GithubRepo.download_directory" href="#jumpscale.clients.github.repo.GithubRepo.download_directory">download_directory</a></code></li>
<li><code><a title="jumpscale.clients.github.repo.GithubRepo.get_color" href="#jumpscale.clients.github.repo.GithubRepo.get_color">get_color</a></code></li>
<li><code><a title="jumpscale.clients.github.repo.GithubRepo.get_git_tree" href="#jumpscale.clients.github.repo.GithubRepo.get_git_tree">get_git_tree</a></code></li>
<li><code><a title="jumpscale.clients.github.repo.GithubRepo.get_issue" href="#jumpscale.clients.github.repo.GithubRepo.get_issue">get_issue</a></code></li>
<li><code><a title="jumpscale.clients.github.repo.GithubRepo.get_issue_from_markdown" href="#jumpscale.clients.github.repo.GithubRepo.get_issue_from_markdown">get_issue_from_markdown</a></code></li>
<li><code><a title="jumpscale.clients.github.repo.GithubRepo.get_milestone" href="#jumpscale.clients.github.repo.GithubRepo.get_milestone">get_milestone</a></code></li>
<li><code><a title="jumpscale.clients.github.repo.GithubRepo.getlabel" href="#jumpscale.clients.github.repo.GithubRepo.getlabel">getlabel</a></code></li>
<li><code><a title="jumpscale.clients.github.repo.GithubRepo.issues" href="#jumpscale.clients.github.repo.GithubRepo.issues">issues</a></code></li>
<li><code><a title="jumpscale.clients.github.repo.GithubRepo.issues_by_priority" href="#jumpscale.clients.github.repo.GithubRepo.issues_by_priority">issues_by_priority</a></code></li>
<li><code><a title="jumpscale.clients.github.repo.GithubRepo.issues_by_state" href="#jumpscale.clients.github.repo.GithubRepo.issues_by_state">issues_by_state</a></code></li>
<li><code><a title="jumpscale.clients.github.repo.GithubRepo.issues_by_type" href="#jumpscale.clients.github.repo.GithubRepo.issues_by_type">issues_by_type</a></code></li>
<li><code><a title="jumpscale.clients.github.repo.GithubRepo.issues_by_type_state" href="#jumpscale.clients.github.repo.GithubRepo.issues_by_type_state">issues_by_type_state</a></code></li>
<li><code><a title="jumpscale.clients.github.repo.GithubRepo.labelnames" href="#jumpscale.clients.github.repo.GithubRepo.labelnames">labelnames</a></code></li>
<li><code><a title="jumpscale.clients.github.repo.GithubRepo.labels" href="#jumpscale.clients.github.repo.GithubRepo.labels">labels</a></code></li>
<li><code><a title="jumpscale.clients.github.repo.GithubRepo.labelsSet" href="#jumpscale.clients.github.repo.GithubRepo.labelsSet">labelsSet</a></code></li>
<li><code><a title="jumpscale.clients.github.repo.GithubRepo.milestone_names" href="#jumpscale.clients.github.repo.GithubRepo.milestone_names">milestone_names</a></code></li>
<li><code><a title="jumpscale.clients.github.repo.GithubRepo.milestone_titles" href="#jumpscale.clients.github.repo.GithubRepo.milestone_titles">milestone_titles</a></code></li>
<li><code><a title="jumpscale.clients.github.repo.GithubRepo.milestones" href="#jumpscale.clients.github.repo.GithubRepo.milestones">milestones</a></code></li>
<li><code><a title="jumpscale.clients.github.repo.GithubRepo.name" href="#jumpscale.clients.github.repo.GithubRepo.name">name</a></code></li>
<li><code><a title="jumpscale.clients.github.repo.GithubRepo.priorities" href="#jumpscale.clients.github.repo.GithubRepo.priorities">priorities</a></code></li>
<li><code><a title="jumpscale.clients.github.repo.GithubRepo.set_file" href="#jumpscale.clients.github.repo.GithubRepo.set_file">set_file</a></code></li>
<li><code><a title="jumpscale.clients.github.repo.GithubRepo.states" href="#jumpscale.clients.github.repo.GithubRepo.states">states</a></code></li>
<li><code><a title="jumpscale.clients.github.repo.GithubRepo.stories" href="#jumpscale.clients.github.repo.GithubRepo.stories">stories</a></code></li>
<li><code><a title="jumpscale.clients.github.repo.GithubRepo.tasks" href="#jumpscale.clients.github.repo.GithubRepo.tasks">tasks</a></code></li>
<li><code><a title="jumpscale.clients.github.repo.GithubRepo.type" href="#jumpscale.clients.github.repo.GithubRepo.type">type</a></code></li>
<li><code><a title="jumpscale.clients.github.repo.GithubRepo.types" href="#jumpscale.clients.github.repo.GithubRepo.types">types</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>